{"ast":null,"code":"import cacheManager from './cache';\nconst API_BASE = 'https://itx-frontend-test.onrender.com/api';\n\n// Gesti√≥n manual de la sesi√≥n (simulando cookies)\nlet sessionId = localStorage.getItem('sessionId') || null;\n\n// Funci√≥n para extraer cookies de la respuesta\nconst extractSessionFromHeaders = response => {\n  const setCookie = response.headers.get('set-cookie');\n  if (setCookie) {\n    console.log('üç™ Cookie recibida:', setCookie);\n    // Aqu√≠ extraer√≠amos el sessionId si estuviera disponible\n  }\n};\nexport const getProducts = async () => {\n  const cached = cacheManager.get('products');\n  if (cached) {\n    console.log('‚úÖ Usando productos desde cach√©');\n    return cached;\n  }\n  console.log('üì° Obteniendo productos desde API');\n  try {\n    const response = await fetch(`${API_BASE}/product`);\n    if (!response.ok) {\n      throw new Error(`Error ${response.status}: ${response.statusText}`);\n    }\n    const data = await response.json();\n    cacheManager.set('products', data);\n    return data;\n  } catch (error) {\n    console.error('‚ùå Error obteniendo productos:', error);\n    throw error;\n  }\n};\nexport const getProduct = async id => {\n  const cached = cacheManager.get(`product-${id}`);\n  if (cached) {\n    console.log(`‚úÖ Usando producto ${id} desde cach√©`);\n    return cached;\n  }\n  console.log(`üì° Obteniendo producto ${id} desde API`);\n  try {\n    const response = await fetch(`${API_BASE}/product/${id}`);\n    console.log(`üìä Status de respuesta para ${id}:`, response.status);\n    if (!response.ok) {\n      throw new Error(`Error ${response.status}: Producto no encontrado`);\n    }\n    const data = await response.json();\n    console.log(`‚úÖ Producto ${id} obtenido:`, data);\n    cacheManager.set(`product-${id}`, data);\n    return data;\n  } catch (error) {\n    console.error(`‚ùå Error obteniendo producto ${id}:`, error);\n    throw error;\n  }\n};\nexport const addToCart = async productData => {\n  console.log('üõí A√±adiendo producto al carrito:', productData);\n  console.log('üîë Session ID actual:', sessionId);\n  try {\n    const headers = {\n      'Content-Type': 'application/json'\n    };\n\n    // Si tenemos un sessionId, lo enviamos como header\n    if (sessionId) {\n      headers['X-Session-Id'] = sessionId;\n    }\n    const response = await fetch(`${API_BASE}/cart`, {\n      method: 'POST',\n      headers: headers,\n      body: JSON.stringify(productData)\n    });\n    console.log('üìä Status de respuesta del carrito:', response.status);\n    console.log('üìã Headers de respuesta:', [...response.headers.entries()]);\n\n    // Intentar extraer sesi√≥n de los headers\n    extractSessionFromHeaders(response);\n    if (!response.ok) {\n      const errorText = await response.text();\n      console.error('‚ùå Error response del carrito:', errorText);\n      throw new Error(`Error ${response.status}: ${response.statusText}`);\n    }\n    const data = await response.json();\n    console.log('‚úÖ Respuesta del carrito:', data);\n\n    // Si la respuesta incluye un sessionId, guardarlo\n    if (data.sessionId) {\n      sessionId = data.sessionId;\n      localStorage.setItem('sessionId', sessionId);\n      console.log('üíæ Session ID guardado:', sessionId);\n    }\n    return data;\n  } catch (error) {\n    console.error('‚ùå Error en addToCart:', error);\n    throw error;\n  }\n};\n\n// Funci√≥n para limpiar la sesi√≥n (√∫til para testing)\nexport const clearSession = () => {\n  sessionId = null;\n  localStorage.removeItem('sessionId');\n  console.log('üóëÔ∏è Sesi√≥n limpiada');\n};","map":{"version":3,"names":["cacheManager","API_BASE","sessionId","localStorage","getItem","extractSessionFromHeaders","response","setCookie","headers","get","console","log","getProducts","cached","fetch","ok","Error","status","statusText","data","json","set","error","getProduct","id","addToCart","productData","method","body","JSON","stringify","entries","errorText","text","setItem","clearSession","removeItem"],"sources":["C:/Users/Metal/Desktop/Escritorio/Proyectos/mobile-store/src/services/api.js"],"sourcesContent":["import cacheManager from './cache';\r\n\r\nconst API_BASE = 'https://itx-frontend-test.onrender.com/api';\r\n\r\n// Gesti√≥n manual de la sesi√≥n (simulando cookies)\r\nlet sessionId = localStorage.getItem('sessionId') || null;\r\n\r\n// Funci√≥n para extraer cookies de la respuesta\r\nconst extractSessionFromHeaders = (response) => {\r\n  const setCookie = response.headers.get('set-cookie');\r\n  if (setCookie) {\r\n    console.log('üç™ Cookie recibida:', setCookie);\r\n    // Aqu√≠ extraer√≠amos el sessionId si estuviera disponible\r\n  }\r\n};\r\n\r\nexport const getProducts = async () => {\r\n  const cached = cacheManager.get('products');\r\n  if (cached) {\r\n    console.log('‚úÖ Usando productos desde cach√©');\r\n    return cached;\r\n  }\r\n  \r\n  console.log('üì° Obteniendo productos desde API');\r\n  \r\n  try {\r\n    const response = await fetch(`${API_BASE}/product`);\r\n    \r\n    if (!response.ok) {\r\n      throw new Error(`Error ${response.status}: ${response.statusText}`);\r\n    }\r\n    \r\n    const data = await response.json();\r\n    cacheManager.set('products', data);\r\n    return data;\r\n  } catch (error) {\r\n    console.error('‚ùå Error obteniendo productos:', error);\r\n    throw error;\r\n  }\r\n};\r\n\r\nexport const getProduct = async (id) => {\r\n  const cached = cacheManager.get(`product-${id}`);\r\n  if (cached) {\r\n    console.log(`‚úÖ Usando producto ${id} desde cach√©`);\r\n    return cached;\r\n  }\r\n  \r\n  console.log(`üì° Obteniendo producto ${id} desde API`);\r\n  \r\n  try {\r\n    const response = await fetch(`${API_BASE}/product/${id}`);\r\n    \r\n    console.log(`üìä Status de respuesta para ${id}:`, response.status);\r\n    \r\n    if (!response.ok) {\r\n      throw new Error(`Error ${response.status}: Producto no encontrado`);\r\n    }\r\n    \r\n    const data = await response.json();\r\n    console.log(`‚úÖ Producto ${id} obtenido:`, data);\r\n    \r\n    cacheManager.set(`product-${id}`, data);\r\n    return data;\r\n  } catch (error) {\r\n    console.error(`‚ùå Error obteniendo producto ${id}:`, error);\r\n    throw error;\r\n  }\r\n};\r\n\r\nexport const addToCart = async (productData) => {\r\n  console.log('üõí A√±adiendo producto al carrito:', productData);\r\n  console.log('üîë Session ID actual:', sessionId);\r\n  \r\n  try {\r\n    const headers = {\r\n      'Content-Type': 'application/json',\r\n    };\r\n    \r\n    // Si tenemos un sessionId, lo enviamos como header\r\n    if (sessionId) {\r\n      headers['X-Session-Id'] = sessionId;\r\n    }\r\n    \r\n    const response = await fetch(`${API_BASE}/cart`, {\r\n      method: 'POST',\r\n      headers: headers,\r\n      body: JSON.stringify(productData)\r\n    });\r\n    \r\n    console.log('üìä Status de respuesta del carrito:', response.status);\r\n    console.log('üìã Headers de respuesta:', [...response.headers.entries()]);\r\n    \r\n    // Intentar extraer sesi√≥n de los headers\r\n    extractSessionFromHeaders(response);\r\n    \r\n    if (!response.ok) {\r\n      const errorText = await response.text();\r\n      console.error('‚ùå Error response del carrito:', errorText);\r\n      throw new Error(`Error ${response.status}: ${response.statusText}`);\r\n    }\r\n    \r\n    const data = await response.json();\r\n    console.log('‚úÖ Respuesta del carrito:', data);\r\n    \r\n    // Si la respuesta incluye un sessionId, guardarlo\r\n    if (data.sessionId) {\r\n      sessionId = data.sessionId;\r\n      localStorage.setItem('sessionId', sessionId);\r\n      console.log('üíæ Session ID guardado:', sessionId);\r\n    }\r\n    \r\n    return data;\r\n  } catch (error) {\r\n    console.error('‚ùå Error en addToCart:', error);\r\n    throw error;\r\n  }\r\n};\r\n\r\n// Funci√≥n para limpiar la sesi√≥n (√∫til para testing)\r\nexport const clearSession = () => {\r\n  sessionId = null;\r\n  localStorage.removeItem('sessionId');\r\n  console.log('üóëÔ∏è Sesi√≥n limpiada');\r\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}